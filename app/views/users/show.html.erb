<p id="notice"><%= notice %></p>

<div class="container-fluid">
  <div class="row">

    <div class="col-md-4">
      <% if @user.has_photo? %>
        <div class="profile-img">
          <%= image_tag('profile.png',class: "rounded")%>
          <div class="file btn btn-lg btn-primary">
              Editar Foto
              <input type="file" name="file"/>
          </div>
        </div>
      <% else %>
        No photo.
      <% end %>
    </div>

    <div class="col-md-8">
      <div class="profile-header">
        <h2 class="name"><%= @user.name %></h2>
        <h3 class="description"><small><%= @user.description %></small></h3>
      </div>
      <div class="profile-details">
        <div class="row">
          <div class="col-md-6">
            <h6>Idade: <%= @user.age %> anos</h6>
            <h6>Modalidade: <%= @user.category %></h6>
          </div>
          <div class="col-md-6">
            <h6>Altura: <%= @user.height %> m</h6>
            <h6>Peso: <%= @user.weight %> kg</h6>
          </div>
        </div>
      </div>

    </div>  
  </div>
</div>
  <!--p>
    <strong>Email:</strong>
    <%= @user.email %>
  </p>

  <p>
    <strong>Document:</strong>
    <%= @user.document %>
  </p>

  <p>
    <strong>Pwd:</strong>
    <%= @user.pwd %>
  </p>

  <p>
    <strong>Age:</strong>
    <%= @user.age %>
  </p>

  <p>
    <strong>Height:</strong>
    <%= @user.height %>
  </p>

  <p>
    <strong>Weight:</strong>
    <%= @user.weight %>
  </p>

  <p>
    <strong>Category:</strong>
    <%= @user.category %>
  </p>

  <p>
    <strong>Description:</strong>
    <%= @user.description %>
  </p>

  <p>
    <strong>Role:</strong>
    <%= @user.role %>
  </p-->

<div class="container">
<div class="animation">
<table>
  <thead>
    <tr>
      <th>Data</th>
      <th>Descrição</th>
      <th>Valor</th>
      <th>Status</th>
      <th colspan="3"></th>
    </tr>
  </thead>

<h1>Financeiro</h1>

<table>
  <tbody>
    <% @total = 0%>
    <% @user.finances.each do |finance| %>
      <% if finance.status == "Não pago"%>
        <% @total = @total + finance.value%>
      <% end %>
      <tr>
        <td><%= finance.created_at.strftime("%d/%m/%Y") %></td>
        <td><%= finance.debt %></td>
        <td><%= finance.value %></td>
        <td><%= finance.status %></td>
        <!--<td><%= link_to 'Show', finance %></td>-->
        <% if(@current_user.role == 'Técnico' || @current_user.role == 'Diretor') %>
          <td><%= link_to image_tag('edit.png',:size => '20x20'),edit_finance_path(finance)%></td>
          <td><%= link_to image_tag('rubbish-bin.png',:size => '20x20'), finance, method: :delete, data: { confirm: 'Você tem certeza?' } %></td>
        <% end %>
      </tr>
    <% end %>
	<tr>
       <td></td>
      <td><p><strong>Total</strong></p></td>
      <td><%= @total %></td>
    </tr>
  </tbody>
</table>
</div>
</div>

<div class="container">
<div class="animation">
<% if(@current_user.role == 'Técnico' || @current_user.role == 'Diretor') %>
  <div class="new_finance">
    <%= link_to 'Novo Pagamento', new_finance_path %>
  </div>
<% end %>

<h1>Performances</h1>

<table>
  <thead>
    <tr>
      <th>Modalidade</th>
      <th>Distância</th>
      <th>Tamanho da Piscina</th>
      <th>Tempo</th>
      <th>Data</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @user.performances.each do |performance| %>
      <tr>
        <td><%= performance.style %></td>
        <td><%= String(performance.distance) + 'm' %></td>
        <td><%= String(performance.pool_length) + 'm' %></td>
        <% if performance.time >= 60 %>
          <% @minute = Integer(performance.time)/60 %>
          <% @remainder_sec = (performance.time%60).floor %>
          <% @remainder = Integer((performance.time%1)*100)%>
          <td><%= String(@minute) + '.' + String(@remainder_sec) + ':' + String(@remainder) %></td>
        <% else %> 
          <td><%= performance.time %></td>
        <% end %>
        <td><%= performance.date.strftime("%d/%m/%Y") %></td>
        <!--td><%= link_to 'Show', performance %></td-->
        <td><%= link_to image_tag('edit.png',:size => '20x20'),edit_performance_path(performance)%></td>
        <td><%= link_to image_tag('rubbish-bin.png',:size => '20x20'), performance, method: :delete, data: { confirm: 'Você tem certeza?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>
</div>

<div class="animation">

<h1>Inscrições</h1>

<table>
  <thead>
    <tr>
      <th>Evento</th>
	  <th>Data</th>
      <th>Status</th>
      <th>Info. Adicional</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @user.subscriptions.each do |subscription| %>
      <tr>
        <td><%= subscription.event.name %></td>
		<td><%= subscription.event.date %></td>
        <td><%= subscription.status %></td>
        <td><%= subscription.additional_info %></td>
        <!--td><%= link_to 'Show', subscription %></td-->

        <td><%= link_to image_tag('edit.png',:size => '20x20'),edit_subscription_path(subscription)%></td>
        <td><%= link_to image_tag('rubbish-bin.png',:size => '20x20'), subscription, method: :delete, data: { confirm: 'Você tem certeza?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>
</div>

<div class="new_subscription">
  <%= link_to 'Nova Inscrição', new_subscription_path %>
</div>

<%= link_to 'Edit', edit_user_path(@user) %> |
<%= link_to 'Back', users_path %>


<script>
jQuery(document).ready(function() {
    jQuery('.animation').addClass("hidden").viewportChecker({
        classToAdd: 'visible animated fadeIn speed',
        offset: 100
       });
});
</script>