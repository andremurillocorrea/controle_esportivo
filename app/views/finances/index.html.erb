<p id="notice"><%= notice %></p>
<%= search_form_for @q do |f| %>
  <%= f.label :Iniciais_do_nome %>
  <%= f.search_field :user_name_start %>
  
  <%= f.label :Referente %>
  <%= f.search_field :debt_cont %>
  
  <%= f.label :Data_minima %>
  <%= f.date_select :created_at_gteq, {order:  [:day, :month, :year],include_blank: true}   %>


  <%= f.label :Data_maxima %>
  <%= f.date_select :created_at_lteq, {order:  [:day, :month, :year],include_blank: true}   %>
  
  <%= f.label :Status %>
  <%= f.select :status_eq, ["Não pago" , "Pago" ], include_blank: true %>
  
  <%= f.submit %>
<% end %>
 
<h1>Finances</h1>

<table>
  <thead>
    <tr>
	  <th><%= sort_link(@q, :Data) %></th>
	  <th><%= sort_link(@q, :Usuario) %></th>
      <th><%= sort_link(@q, :Referente) %></th>
      <th><%= sort_link(@q, :Value) %></th>
      <th><%= sort_link(@q, :Status) %></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @total = 0%>
    <% @finances.each do |finance| %>
      <% if finance.status == "Não pago"%>
        <% @total = @total + finance.value%>
      <% end %>
      <tr>
        <td><%= finance.created_at.strftime("%d/%m/%Y") %></td>
		<td><%= finance.user.name %></td>
        <td><%= finance.debt %></td>
        <td><%= finance.value %></td>
        <td><%= finance.status %></td>
        <!--<td><%= link_to 'Show', finance %></td>-->
        <td><%= link_to 'Edit Debt', edit_finance_path(finance) %></td>
        <td><%= link_to 'Destroy', finance, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
    <tr>
       <td></td>
      <td><p><strong>Debt Total</strong></p></td>
      <td><%= @total %></td>
    </tr>
  </tbody>
</table>

<br>

<%= link_to 'New Finance', new_finance_path %>
